## DBA 智能体来了: Xata   
                                                                                                                              
### 作者                                                                                                  
digoal                                                                                                  
                                                                                                         
### 日期                                                                                                       
2025-03-21                                                                                                 
                                                                                                      
### 标签                                                                                                    
PostgreSQL , PolarDB , DuckDB , DBA , AI Agent   
                                                                                                                             
----                                                                                                      
                                                                                                                    
## 背景       
Xata Agent是什么? 您的 PostgreSQL 人工智能专家. 以后企业的DBA团队可能是人类DBA早九晚五 + 智能体DBA 7*24的组合.  想想是不是很幸福.    
- https://github.com/xataio/agent   
  
Xata Agent 是一款开源代理，可监控您的数据库、查找问题的根本原因并提出修复和改进建议。这就像在您的团队中聘请了一位新的 SRE，一位在 Postgres 方面拥有丰富经验的人。  
  
这个开源项目目前还在初级阶段, 看这个开源项目的设计应该是由人类来定义智能体的任务(剧本), 自动触发执行事先定义的脚本(防止智能体做出删库跑路的事情).    
  
同时该开源项目也在开发云服务(商业模式), 也就是你可以雇佣它作为远程DBA.  还比较有意思, 下面看看它的 readme .   
  
聘请我担任您的 AI PostgreSQL 专家。我可以：  
- 查看日志和指标以发现潜在问题。  
- 主动建议您调整数据库实例的配置。  
- 解决性能问题并提出索引建议。  
- 解决常见问题，例如 CPU 使用率高、内存使用率高、连接数高等。  
- 并帮助您打扫（您的 Postgres DB，而不是您的房间）。  
  
关于我的更多信息：  
- 我是开源的并且可扩展的。  
- 我可以通过 Cloudwatch 监控来自 RDS 和 Aurora 的日志和指标。  
- 我使用预设的 SQL 命令。我绝不会对您的数据库运行破坏性（甚至潜在破坏性）的命令。  
- 我使用一套工具和剧本来指导我并避免出现幻觉。  
- 我可以运行故障排除语句，例如查看 pg_stat_statements、pg_locks 等，以发现问题的根源。  
- 如果出现问题，我可以通过 Slack 通知您。  
- 我支持来自 OpenAI、Anthropic 和 Deepseek 的多种模型。  
  
过去的经历：  
- 我一直在帮助 Xata 团队监控和操作大量活跃的 Postgres 数据库。  
  
## 安装/自托管  
  
我们为代理本身提供 Docker 镜像。唯一的其他依赖项是 Postgres 数据库，代理将在其中存储其配置、状态和历史记录。  
  
我们提供了一个 docker-compose 文件来启动代理和 Postgres 数据库。  
  
编辑.env.production项目根目录中的文件。您需要PUBLIC_URL至少设置 OpenAI 的 API 密钥。  
  
通过docker compose启动本地实例：  
```  
docker compose up  
```  
  
打开应用程序`http://localhost:8080`（或您在文件中设置的公共 URL `.env.production`）并按照入职步骤进行操作。  
  
我们有关于如何在 EC2 实例上通过 docker-compose 进行部署的更详细指南。 https://github.com/xataio/agent/wiki/Xata-Agent-%E2%80%90-Deploy-on-EC2    
  
对于身份验证，您可以使用自己的 OAuth 提供程序。  
  
### 可扩展性  
该代理可以通过以下机制进行扩展：  
- 工具：这些是代理可以调用以获取有关数据库的信息的函数。它们以 TypeScript 编写，请参阅此文件了解它们的描述。 https://github.com/xataio/agent/blob/main/apps/dbagent/src/lib/ai/aidba.ts#L50   
- 剧本：这些是代理可以遵循的步骤序列，用于解决问题。它们仅用英文编写。预定义的剧本在这里。 https://github.com/xataio/agent/blob/main/apps/dbagent/src/lib/tools/playbooks.ts   
- 集成：例如，AWS 和 Slack 集成。它们包含配置和 UI 小部件。  
  
## 现状/路线图  
  
虽然还处于早期阶段，但我们在 Xata 的日常运营工作中已经使用了该代理。  
  
- 剧本:  
  - [x] 一般监控  
  - [x] 调整设置  
  - [x] 调查慢速查询  
  - [x] 调查高 CPU  
  - [x] 调查高内存  
  - [x] 调查高连接数  
  - [ ] 调查锁  
  - [ ] 调查垃圾回收  
  - [ ] 其他剧本（请告知我们）  
- MCP 集成:  
  - [ ] 充当其他代理的 MCP 服务器  
  - [ ] 通过 MCP 在网络上调用工具  
- 支持更多云提供商:  
  - [x] AWS RDS  
  - [x] AWS Aurora  
  - [ ] Google Cloud SQL  
  - [ ] Azure Database for PostgreSQL  
  - [ ] Digital Ocean Managed Databases  
  - [ ] Other (please let us know)  
- 通知和集成:  
  - [x] Simple Slack integration  
  - [ ] Slack integration as an AI agent (https://github.com/xataio/agent/pull/29)  
  - [ ] Discord integration  
  - [ ] Other (please let us know)  
- 评估和测试:  
  - [ ] 添加与 LLM 交互的评估测试 (https://github.com/xataio/agent/pull/38)  
- 审批流程:  
  - [ ] 为代理添加审批工作流以运行具有潜在危险的语句  
  - [ ] 允许配置可根据监控计划定义的工具  
  
虽然 Agent 本质上主要是您自行托管的开源项目，但我们也在开发云版本。云版本的优势在于某些集成更易于安装。  
  
国内的数据库生态产品是否会跟进呢, 期待Ninedata, Apecloud, dbdoctor, dsmart等国内数据库生态产品最新消息.   
  
   
